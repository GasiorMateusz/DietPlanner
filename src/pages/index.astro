---
import { createSupabaseServerClient } from "@/db/supabase.server";
import { getAuthenticatedUser } from "@/lib/auth/auth-state.server";

const supabase = createSupabaseServerClient(Astro.cookies);
const user = await getAuthenticatedUser(supabase);

if (user) {
  return Astro.redirect("/app/dashboard");
}

// Redirect to login page to reuse the same view
return Astro.redirect("/auth/login", 307);
---
